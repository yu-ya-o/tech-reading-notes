# 『Web API The Good Parts』 読書メモ

## 書籍情報
- タイトル：Web API The Good Parts
- 著者：水野 貴明
- 出版年：2014年
- ISBN：978-4873116860

## 読書の目的
- Web API設計の優れた技術・設計原則を理解する
- 実践的で使いやすいAPI設計を学び、自身の開発に活かす

## 読書進捗

- [x] ch01：WebAPIとは何か
- [x] ch02：エンドポイントの設計とリクエストの形式
- [x] ch03：レスポンスデータの設計
- [x] ch04：HTTPの仕様を最大限利用する
- [x] ch05：設計変更をしやすいWeb APIを作る
- [x] ch06：堅牢なWeb APIを作る

## まとめ
### ch01:WebAPIとは何か
- HTTPプロトコルを利用してネットワーク越しに呼び出すAPI

#### WebAPIを公開する重要性、ポイント
- APIの利用を前提としたサービスが当たり前になってきている
- 他の企業や個人があなたのサービスに付加価値を提供してくれるためのインターフェースになる
- 美しいコードと同じように、WebAPIも美しく設計する必要がある

### ch02:エンドポイントの設計とリクエストの形式

#### 公開する機能を設計する
- 何を公開するのか決める上で重要なのは、ユースケースをきちんと考えること

#### APIエンドポイントとメソッド
- 覚えやすく、どんな機能を持つURIなのかが一目でわかること
- エンドポイントとHTTPメソッドは、「操作対象（＝リソース）」に対して「何をするか」を表す
- GET, POST, PUT/PATCH, DELETE

例）SNS
- ユーザーの一覧取得
  - GET
  - https://api.example.com/v1/users
- ユーザーの新規登録
  - POST
  - https://api.example.com/v1/users
- 特定のユーザーの取得
  - GET
  - https://api.example.com/v1/users:id
- ユーザー情報の更新
  - PUT/PATCH
  - https://api.example.com/v1/users:id
- ユーザー情報の削除
  - DELETE
  - https://api.example.com/v1/users:id

#### 認証API
- OAuth2.0

### ch03:レスポンスデータの設計

#### データフォーマット
- JSONがデフォルト、必要があればXMLに対応する
- 指定方法は、①クエリパラメータ、②拡張子、③リクエストヘッダがあり、①が最も多く使われている

#### データ内部構造
- テーブル構造の反映は不要
- WebAPIはデータベースのアクセスインターフェースではなく、アプリケーションのインターフェースであるため、利用者が使いやすい構造を選ぶべき

#### エラーの表現
- ステータスコードで表現すべき
- エラー詳細は、①レスポンスヘッダ、②レスポンスボディのどちらかでクライアントに返す

### ch04:HTTPの仕様を最大限利用する
- 公開するAPIの仕様や挙動を決定する際の原則として、既存の標準仕様を遵守すること、デファクトスタンダードは守ること
- ステータスコードは正しく使う
- キャッシュは正しく有効活用する
- メディアタイプはContent-Typeで指定する
- メディアタイプは正しく指定しないとセキュリティ上の問題を引き起こす可能性がある
- 同一生成元ポリシーとクロスオリジンリソース共有の理解

### ch05:設計変更をしやすいWebAPIを作る
- WebAPIの変更や廃止は、多数の外部アプリケーションに影響を及ぼすため、影響が最小限になるように設計をしなければならない

#### ポイント
- URIでバージョン管理をする
- - https://api.example.com/v1/users
- - https://api.example.com/v2/users
- 後方互換を保つことが難しい場合のみ、バージョンを変えるようにする
- APIの提供終了は避けたいが、最悪を想定してあらかじめ提供終了時の仕様を盛り込んでおくべき
- 利用規約にサポート期限の明記する

### ch06:堅牢なWebAPIを作る
- 「安全性」と「安定性」
- HTTPSによるHTTP通信の暗号化をする
- XSS, XSRF, JSONハイジャック対策
- 悪意あるアクセスへの対策
- セキュリティ関係のHTTPヘッダの利用

